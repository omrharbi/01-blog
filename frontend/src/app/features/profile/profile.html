<main class="container-fluid px-3 px-lg-4 py-4  ">
    <div class="mb-5">
        <!-- Cover Image -->
        <div class="position-relative mb-5">
            <div class="cover-image">
                <img src="https://images.unsplash.com/photo-1579546929518-9e396f3cc809?w=1200" alt="Cover">
            </div>

            <!-- Profile Avatar -->
            <div class="profile-avatar">
                <!-- <img [src]="(userProfile.avatar?.startsWith('http')?userProfile.avatar:apiUrl+userProfile.avatar)" alt="John Developer"> -->
            </div>

            <!-- Action Buttons -->
            <div class="position-absolute bottom-0 end-0 p-3 d-flex gap-2">
                <ng-container *ngIf="isPostOwner(userProfile.id); else followUnfollowBlock">
                    <!-- Edit Profile button for owner -->
                    <button class="btn btn-custom-secondary d-flex align-items-center gap-2" (click)="EditProfile()">
                        <i class="bi bi-gear"></i>
                        <span class="d-none d-sm-inline">Edit Profile</span>
                    </button>
                </ng-container>

                <ng-template #followUnfollowBlock>
                    <!-- Follow / Unfollow button for other users -->
                    <button class="btn btn-primary" (click)="toggleFollow(userProfile.id)">
                        <i class="bi" [ngClass]="isFollowing ? 'bi-person-dash' : 'bi-person-plus'"></i>
                        <span class="d-none d-sm-inline">{{ isFollowing ? 'Unfollow' : 'Follow' }}</span>
                    </button>
                </ng-template>


                <button class="btn btn-custom-primary d-flex align-items-center gap-2">
                    <i class="bi bi-plus"></i>
                    <span class="d-none d-sm-inline">Write Story</span>
                </button>
            </div>
        </div>
        <ng-container *ngIf="!editProfile">
            <!-- Profile Info -->
            <div class="px-4" style="padding-top: 4rem;">
                <div class="mb-4">
                    <div class="d-flex align-items-center gap-2 mb-2">
                        <h1 class="h2 font-playfair fw-bold mb-0">{{userProfile.firstname | uppercase}}
                            {{userProfile.lastname | uppercase}}</h1>
                        <!-- <span class="badge badge-verified">Verified</span> -->
                    </div>
                    <p class="fs-5 text-muted-custom mb-3">@{{userProfile.username}}</p>
                </div>

                <p class="mb-4 text-secondary-custom" style="max-width: 600px; line-height: 1.6;">
                    {{userProfile.about}}
                    <!-- Full-stack developer passionate about React, Node.js, and building great user experiences. Sharing my learning journey and insights from 5+ years in tech. -->
                </p>

                <!-- Meta Info -->
                <!-- <div class="d-flex flex-wrap gap-4 mb-4 small text-muted-custom">
                        <div class="d-flex align-items-center gap-1">
                            <i class="bi bi-geo-alt"></i>
                            <span>San Francisco, CA</span>
                        </div>
                        <div class="d-flex align-items-center gap-1">
                            <i class="bi bi-link-45deg"></i>
                            <a href="https://johndev.com" class="text-decoration-none" style="color: var(--brand-primary);" target="_blank">johndev.com</a>
                        </div>
                        <div class="d-flex align-items-center gap-1">
                            <i class="bi bi-calendar"></i>
                            <span>Joined March 2021</span>
                        </div>
                    </div> -->
                <!-- Stats -->
                <div class="d-flex gap-5 mb-4">
                    <div class="text-center">
                        <div class="h3 fw-bold mb-0">{{userProfile.followingCount }}</div>
                        <div class="small text-muted-custom">Following</div>
                    </div>
                    <div class="text-center">
                        <div class="h3 fw-bold mb-0">{{userProfile.followersCount }}</div>
                        <div class="small text-muted-custom">Followers</div>
                    </div>
                    <div class="text-center">
                        <div class="h3 fw-bold mb-0">{{userProfile.postsCount }}</div>
                        <div class="small text-muted-custom">Posts</div>
                    </div>
                </div>

                <!-- Tags -->
                <div class="skills d-flex ">

                    <ng-container *ngFor="let skl of userProfile.skills ">
                        <div class="d-flex flex-wrap gap-2 mb-4 p-1">
                            <span class="tag">{{skl}}</span>
                        </div>
                    </ng-container>
                </div>

            </div>

            <!-- Tabs -->
            <ul class="nav nav-tabs-custom mt-5" id="profileTabs" role="tablist">
                <li class="nav-item flex-fill" role="presentation">
                    <button class="nav-link active w-100" id="posts-tab" data-bs-toggle="tab" data-bs-target="#posts"
                        type="button" role="tab">
                        <i class="bi bi-file-text me-2"></i>Posts (42)
                    </button>
                </li>
                <li class="nav-item flex-fill" role="presentation">
                    <button class="nav-link w-100" id="likes-tab" data-bs-toggle="tab" data-bs-target="#likes"
                        type="button" role="tab">
                        <i class="bi bi-heart me-2"></i>Likes
                    </button>
                </li>
                <!-- <li class="nav-item flex-fill" role="presentation">
                        <button class="nav-link w-100" id="bookmarks-tab" data-bs-toggle="tab" data-bs-target="#bookmarks" type="button" role="tab">
                            <i class="bi bi-bookmark me-2"></i>Bookmarks
                        </button>
                    </li> -->
                <li class="nav-item flex-fill" role="presentation">
                    <button class="nav-link w-100" id="about-tab" data-bs-toggle="tab" data-bs-target="#about"
                        type="button" role="tab">
                        <i class="bi bi-person me-2"></i>About
                    </button>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content mt-4" id="profileTabsContent">
                <!-- Posts Tab -->
                <div class="tab-pane fade show active" id="posts" role="tabpanel">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="h3 font-playfair fw-bold">Published Posts</h2>
                        <!-- <div class="btn-group">
                                <button class="btn btn-sm btn-custom-secondary">Latest</button>
                                <button class="btn btn-sm btn-custom-secondary">Popular</button>
                            </div> -->
                    </div>


                    <!-- Story Card 2 -->
                    <ng-container *ngFor="let p of post">

                        <div class="card card-custom mb-4">
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between align-items-start mb-3">
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="avatar-sm">
                                            <!-- <img [src]="(userProfile.avatar?.startsWith('http')?userProfile.avatar:apiUrl+userProfile.avatar)" alt="userProfile.username"> -->
                                        </div>
                                        <div>
                                            <a href="#" class="fw-medium text-decoration-none link-hover"
                                                style="color: var(--foreground-color);">{{userProfile.firstname }}
                                                {{userProfile.lastname }}</a>
                                            <div class="small text-muted-custom"> {{userProfile }} 1 week timeAgo ago Â·
                                                12 min read</div>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm icon-btn">
                                        <i class="bi bi-three-dots"></i>
                                    </button>
                                </div>

                                <div class="row g-4">
                                    <div class="col-md-8">
                                        <a routerLink="/post/{{p.id}}" class="text-decoration-none"
                                            style="color: var(--foreground-color);">
                                            <h3 class="h5 font-playfair fw-bold mb-2 line-clamp-2">{{p.title}}</h3>
                                            <div class="text-muted-custom mb-3 line-clamp-3" [innerHTML]="p.content">
                                                <!-- {{p.content}} -->
                                            </div>
                                            <!-- <div ></div> -->
                                        </a>

                                        <div class="d-flex flex-wrap gap-2 mb-3">
                                            <span class="tag tag-muted">GraphQL</span>
                                            <span class="tag tag-muted">API</span>
                                            <span class="tag tag-muted">Backend</span>
                                        </div>

                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="d-flex gap-3">
                                                <button [class.liked]="p.liked" [class.not-liked]="!(p.liked)"
                                                    (click)="toggleLikePost(p.id, p)"
                                                    class="btn btn-link text-decoration-none p-0 d-flex align-items-center gap-2 like-btn">

                                                    <mat-icon [class.liked-icon]="p.liked"
                                                        [class.not-liked-icon]="!(p.liked)">
                                                        {{ p.liked ? 'favorite' : 'favorite_border' }}
                                                    </mat-icon>

                                                    <span [ngClass]="{
                                                            'liked-text': p.liked,
                                                            'not-liked-text': !p.liked
                                                            }">
                                                        {{ p.likesCount }}
                                                    </span>
                                                </button>
                                                <a class="btn btn-link text-muted text-decoration-none p-0 d-flex align-items-center gap-2"
                                                    [queryParams]="{ scrollTo: 'comments' }"
                                                    routerLink="/comments/{{p.id}}">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                        fill="currentColor" class="bi bi-chat" viewBox="0 0 16 16">
                                                        <path
                                                            d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z" />
                                                    </svg>
                                                    {{p.commentCount}}
                                                </a>
                                            </div>
                                            <div class="d-flex gap-2">
                                                <button class="btn btn-sm icon-btn icon-btn-active">
                                                    <i class="bi bi-bookmark-fill"></i>
                                                </button>
                                                <button class="btn btn-sm icon-btn">
                                                    <i class="bi bi-share"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <a href="#">
                                            <div class="card-image">
                                                <img [src]="apiUrl+(p.firstImage || '')" alt="Article">
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                    <div class="text-center mt-5">
                        <button class="btn btn-lg btn-custom-secondary">Load More Posts</button>
                    </div>
                </div>

                <!-- Likes Tab -->
                <div class="tab-pane fade" id="likes" role="tabpanel">
                    <div class="empty-state">
                        <i class="bi bi-heart"></i>
                        <h3 class="h5 mb-2">You haven't liked any posts yet</h3>
                        <p class="text-muted-custom">Start exploring and like posts that interest you.</p>
                    </div>
                </div>



                <!-- About Tab -->
                <div class="tab-pane fade" id="about" role="tabpanel">
                    <div class="row g-4">
                        <div class="col-lg-6">
                            <div class="stats-card">
                                <h4 class="h6 font-playfair fw-bold mb-3">About John Developer</h4>
                                <p class="mb-3" style="line-height: 1.6;">Full-stack developer passionate about React,
                                    Node.js, and building great user experiences. Sharing my learning journey and
                                    insights from 5+ years in tech.</p>
                                <hr class="my-3">
                                <div class="mb-2">
                                    <strong>Location:</strong> San Francisco, CA
                                </div>
                                <div class="mb-2">
                                    <strong>Website:</strong> <a href="https://johndev.com" target="_blank"
                                        style="color: var(--brand-primary);">https://johndev.com</a>
                                </div>
                                <div>
                                    <strong>Member since:</strong> March 2021
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="stats-card">
                                <h4 class="h6 font-playfair fw-bold mb-3">Activity Stats</h4>
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span>Posts published</span>
                                    <strong>42</strong>
                                </div>
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span>Total followers</span>
                                    <strong>1,234</strong>
                                </div>
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span>Following</span>
                                    <strong>567</strong>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span>Account status</span>
                                    <span class="badge badge-verified">Active</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </ng-container>


        <ng-container *ngIf="editProfile">
            <app-edit-profile></app-edit-profile>
        </ng-container>
    </div>
</main>